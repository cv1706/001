<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>åœ‹é“é‡Œç¨‹ã€å¹³å‡è·é›¢èˆ‡è½‰æ›é»è¨ˆç®—å™¨</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; padding: 20px; max-width: 900px; margin: 0 auto; background-color: #f4f4f4; }
        h2 { text-align: center; color: #333; }
        
        .input-group { margin-bottom: 15px; display: flex; gap: 10px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        input { padding: 12px; flex: 1; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
        button { padding: 10px 25px; background-color: #007bff; color: white; border: none; cursor: pointer; border-radius: 4px; font-size: 16px; font-weight: bold; }
        button:hover { background-color: #0056b3; }
        
        /* ç‰ˆé¢é…ç½® */
        #container { display: flex; gap: 20px; height: 500px; margin-top: 20px; }
        #selection-panel { width: 35%; overflow-y: auto; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 10px; }
        #map { width: 65%; background-color: #eee; height: 100%; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* è·¯ç·šæŒ‰éˆ•æ¨£å¼ */
        .route-btn { display: block; width: 100%; padding: 12px; margin-bottom: 8px; background: #fff; border: 1px solid #ddd; text-align: left; cursor: pointer; border-radius: 5px; transition: all 0.2s; }
        .route-btn:hover { background: #f0f0f0; border-color: #aaa; }
        .route-btn.active { background: #e8f0fe; border-color: #007bff; color: #0056b3; border-left: 5px solid #007bff; }

        /* çµ±è¨ˆè³‡è¨Šå€å¡Š */
        .stats-box { background: #e3f2fd; padding: 12px; border-radius: 6px; margin-bottom: 15px; border: 1px solid #bbdefb; font-size: 0.95em; color: #0d47a1; }
        .stats-highlight { color: #d32f2f; font-weight: bold; font-size: 1.1em; }

        /* åˆ†æçµæœå€å¡Š */
        #analysis-result { margin-top: 20px; padding: 20px; background: #fff; border-left: 6px solid #28a745; display: none; border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; }
        .result-item { background: #f9f9f9; padding: 10px; border-radius: 5px; }
        .result-label { font-size: 0.9em; color: #666; font-weight: bold; }
        .result-value { font-size: 1.1em; color: #333; margin-top: 5px; }
        .highlight { color: #d9534f; font-weight: bold; font-size: 1.2em; }
        
        /* äº¤æµé“èˆ‡è½‰æ›é»è³‡è¨Šæ¨£å¼ */
        .ic-info { margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; }
        .ic-step { display: flex; align-items: flex-start; margin-bottom: 12px; }
        .ic-icon { min-width: 30px; color: #28a745; font-weight: bold; margin-right: 8px; font-size: 1.1em; }
        .ic-text { color: #555; line-height: 1.5; }
        
        /* è½‰æ›é»åˆ—è¡¨æ¨£å¼ */
        .transfer-list { margin-top: 5px; padding-left: 10px; border-left: 3px solid #ffc107; background: #fffbf0; padding: 10px; border-radius: 0 5px 5px 0; }
        .transfer-item { margin-bottom: 5px; font-size: 0.95em; color: #444; }
        .transfer-arrow { color: #f57c00; font-weight: bold; padding: 0 5px; }
    </style>
</head>
<body>

    <h2>ğŸš— åœ‹é“é‡Œç¨‹ã€å¹³å‡è·é›¢èˆ‡è½‰æ›é»è¨ˆç®—å™¨</h2>
    
    <div class="input-group">
        <input type="text" id="start" placeholder="è«‹è¼¸å…¥èµ·é» (ä¾‹å¦‚: å°åŒ—101)">
        <input type="text" id="end" placeholder="è«‹è¼¸å…¥çµ‚é» (ä¾‹å¦‚: é«˜é›„å·¦ç‡Ÿé«˜éµ)">
        <button onclick="calculateRoute()">æŸ¥è©¢è·¯ç·š</button>
    </div>

    <div id="analysis-result"></div>

    <div id="container">
        <div id="selection-panel">
            <p style="color:#666; text-align:center; margin-top: 20px;">è«‹å…ˆè¼¸å…¥åœ°é»ä¸¦æŸ¥è©¢...</p>
        </div>
        <div id="map"></div>
    </div>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQsMxnmE1-3YCotbwGKkDhHiaPln8KwIQ&libraries=places"></script>

    <script>
        let map, directionsService, directionsRenderer;
        let allRoutes = [];

        function initMap() {
            const taiwan = { lat: 23.6978, lng: 120.9605 };
            map = new google.maps.Map(document.getElementById("map"), {
                zoom: 7,
                center: taiwan,
                mapTypeControl: false,
                streetViewControl: false
            });
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer();
            directionsRenderer.setMap(map);

            setupAutocomplete("start");
            setupAutocomplete("end");
        }

        function setupAutocomplete(elementId) {
            const input = document.getElementById(elementId);
            const options = {
                componentRestrictions: { country: "tw" },
                fields: ["formatted_address", "geometry", "name"],
            };
            new google.maps.places.Autocomplete(input, options);
        }

        function calculateRoute() {
            const start = document.getElementById("start").value;
            const end =
